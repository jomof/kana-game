/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */
const t=globalThis,n=t.ShadowRoot&&(void 0===t.ShadyCSS||t.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,e=Symbol(),i=new WeakMap;let s=class{constructor(t,n,i){if(this._$cssResult$=!0,i!==e)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=t,this.t=n}get styleSheet(){let t=this.o;const e=this.t;if(n&&void 0===t){const n=void 0!==e&&1===e.length;n&&(t=i.get(e)),void 0===t&&((this.o=t=new CSSStyleSheet).replaceSync(this.cssText),n&&i.set(e,t))}return t}toString(){return this.cssText}};const r=n?t=>t:t=>t instanceof CSSStyleSheet?(t=>{let n="";for(const e of t.cssRules)n+=e.cssText;return(t=>new s("string"==typeof t?t:t+"",void 0,e))(n)})(t):t
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */,{is:o,defineProperty:c,getOwnPropertyDescriptor:h,getOwnPropertyNames:u,getOwnPropertySymbols:a,getPrototypeOf:l}=Object,f=globalThis,d=f.trustedTypes,p=d?d.emptyScript:"",w=f.reactiveElementPolyfillSupport,y=(t,n)=>t,g={toAttribute(t,n){switch(n){case Boolean:t=t?p:null;break;case Object:case Array:t=null==t?t:JSON.stringify(t)}return t},fromAttribute(t,n){let e=t;switch(n){case Boolean:e=null!==t;break;case Number:e=null===t?null:Number(t);break;case Object:case Array:try{e=JSON.parse(t)}catch(t){e=null}}return e}},b=(t,n)=>!o(t,n),m={attribute:!0,type:String,converter:g,reflect:!1,useDefault:!1,hasChanged:b};Symbol.metadata??=Symbol("metadata"),f.litPropertyMetadata??=new WeakMap;let v=class extends HTMLElement{static addInitializer(t){this._$Ei(),(this.l??=[]).push(t)}static get observedAttributes(){return this.finalize(),this._$Eh&&[...this._$Eh.keys()]}static createProperty(t,n=m){if(n.state&&(n.attribute=!1),this._$Ei(),this.prototype.hasOwnProperty(t)&&((n=Object.create(n)).wrapped=!0),this.elementProperties.set(t,n),!n.noAccessor){const e=Symbol(),i=this.getPropertyDescriptor(t,e,n);void 0!==i&&c(this.prototype,t,i)}}static getPropertyDescriptor(t,n,e){const{get:i,set:s}=h(this.prototype,t)??{get(){return this[n]},set(t){this[n]=t}};return{get:i,set(n){const r=i?.call(this);s?.call(this,n),this.requestUpdate(t,r,e)},configurable:!0,enumerable:!0}}static getPropertyOptions(t){return this.elementProperties.get(t)??m}static _$Ei(){if(this.hasOwnProperty(y("elementProperties")))return;const t=l(this);t.finalize(),void 0!==t.l&&(this.l=[...t.l]),this.elementProperties=new Map(t.elementProperties)}static finalize(){if(this.hasOwnProperty(y("finalized")))return;if(this.finalized=!0,this._$Ei(),this.hasOwnProperty(y("properties"))){const t=this.properties,n=[...u(t),...a(t)];for(const e of n)this.createProperty(e,t[e])}const t=this[Symbol.metadata];if(null!==t){const n=litPropertyMetadata.get(t);if(void 0!==n)for(const[t,e]of n)this.elementProperties.set(t,e)}this._$Eh=new Map;for(const[t,n]of this.elementProperties){const e=this._$Eu(t,n);void 0!==e&&this._$Eh.set(e,t)}this.elementStyles=this.finalizeStyles(this.styles)}static finalizeStyles(t){const n=[];if(Array.isArray(t)){const e=new Set(t.flat(1/0).reverse());for(const t of e)n.unshift(r(t))}else void 0!==t&&n.push(r(t));return n}static _$Eu(t,n){const e=n.attribute;return!1===e?void 0:"string"==typeof e?e:"string"==typeof t?t.toLowerCase():void 0}constructor(){super(),this._$Ep=void 0,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Em=null,this._$Ev()}_$Ev(){this._$ES=new Promise((t=>this.enableUpdating=t)),this._$AL=new Map,this._$E_(),this.requestUpdate(),this.constructor.l?.forEach((t=>t(this)))}addController(t){(this._$EO??=new Set).add(t),void 0!==this.renderRoot&&this.isConnected&&t.hostConnected?.()}removeController(t){this._$EO?.delete(t)}_$E_(){const t=new Map,n=this.constructor.elementProperties;for(const e of n.keys())this.hasOwnProperty(e)&&(t.set(e,this[e]),delete this[e]);t.size>0&&(this._$Ep=t)}createRenderRoot(){const e=this.shadowRoot??this.attachShadow(this.constructor.shadowRootOptions);return((e,i)=>{if(n)e.adoptedStyleSheets=i.map((t=>t instanceof CSSStyleSheet?t:t.styleSheet));else for(const n of i){const i=document.createElement("style"),s=t.litNonce;void 0!==s&&i.setAttribute("nonce",s),i.textContent=n.cssText,e.appendChild(i)}})(e,this.constructor.elementStyles),e}connectedCallback(){this.renderRoot??=this.createRenderRoot(),this.enableUpdating(!0),this._$EO?.forEach((t=>t.hostConnected?.()))}enableUpdating(t){}disconnectedCallback(){this._$EO?.forEach((t=>t.hostDisconnected?.()))}attributeChangedCallback(t,n,e){this._$AK(t,e)}_$ET(t,n){const e=this.constructor.elementProperties.get(t),i=this.constructor._$Eu(t,e);if(void 0!==i&&!0===e.reflect){const s=(void 0!==e.converter?.toAttribute?e.converter:g).toAttribute(n,e.type);this._$Em=t,null==s?this.removeAttribute(i):this.setAttribute(i,s),this._$Em=null}}_$AK(t,n){const e=this.constructor,i=e._$Eh.get(t);if(void 0!==i&&this._$Em!==i){const t=e.getPropertyOptions(i),s="function"==typeof t.converter?{fromAttribute:t.converter}:void 0!==t.converter?.fromAttribute?t.converter:g;this._$Em=i,this[i]=s.fromAttribute(n,t.type)??this._$Ej?.get(i)??null,this._$Em=null}}requestUpdate(t,n,e){if(void 0!==t){const i=this.constructor,s=this[t];if(e??=i.getPropertyOptions(t),!((e.hasChanged??b)(s,n)||e.useDefault&&e.reflect&&s===this._$Ej?.get(t)&&!this.hasAttribute(i._$Eu(t,e))))return;this.C(t,n,e)}!1===this.isUpdatePending&&(this._$ES=this._$EP())}C(t,n,{useDefault:e,reflect:i,wrapped:s},r){e&&!(this._$Ej??=new Map).has(t)&&(this._$Ej.set(t,r??n??this[t]),!0!==s||void 0!==r)||(this._$AL.has(t)||(this.hasUpdated||e||(n=void 0),this._$AL.set(t,n)),!0===i&&this._$Em!==t&&(this._$Eq??=new Set).add(t))}async _$EP(){this.isUpdatePending=!0;try{await this._$ES}catch(t){Promise.reject(t)}const t=this.scheduleUpdate();return null!=t&&await t,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){if(!this.isUpdatePending)return;if(!this.hasUpdated){if(this.renderRoot??=this.createRenderRoot(),this._$Ep){for(const[t,n]of this._$Ep)this[t]=n;this._$Ep=void 0}const t=this.constructor.elementProperties;if(t.size>0)for(const[n,e]of t){const{wrapped:t}=e,i=this[n];!0!==t||this._$AL.has(n)||void 0===i||this.C(n,void 0,e,i)}}let t=!1;const n=this._$AL;try{t=this.shouldUpdate(n),t?(this.willUpdate(n),this._$EO?.forEach((t=>t.hostUpdate?.())),this.update(n)):this._$EM()}catch(n){throw t=!1,this._$EM(),n}t&&this._$AE(n)}willUpdate(t){}_$AE(t){this._$EO?.forEach((t=>t.hostUpdated?.())),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(t)),this.updated(t)}_$EM(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$ES}shouldUpdate(t){return!0}update(t){this._$Eq&&=this._$Eq.forEach((t=>this._$ET(t,this[t]))),this._$EM()}updated(t){}firstUpdated(t){}};v.elementStyles=[],v.shadowRootOptions={mode:"open"},v[y("elementProperties")]=new Map,v[y("finalized")]=new Map,w?.({ReactiveElement:v}),(f.reactiveElementVersions??=[]).push("2.1.0");
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */
const k=globalThis,S=k.trustedTypes,O=S?S.createPolicy("lit-html",{createHTML:t=>t}):void 0,j="$lit$",_=`lit$${Math.random().toFixed(9).slice(2)}$`,x="?"+_,A=`<${x}>`,$=document,C=()=>$.createComment(""),N=t=>null===t||"object"!=typeof t&&"function"!=typeof t,E=Array.isArray,U="[ \t\n\f\r]",z=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,M=/-->/g,I=/>/g,P=RegExp(`>|${U}(?:([^\\s"'>=/]+)(${U}*=${U}*(?:[^ \t\n\f\r"'\`<>=]|("|')|))|$)`,"g"),T=/'/g,B=/"/g,D=/^(?:script|style|textarea|title)$/i,J=(t=>(n,...e)=>({_$litType$:t,strings:n,values:e}))(1),R=Symbol.for("lit-noChange"),F=Symbol.for("lit-nothing"),K=new WeakMap,L=$.createTreeWalker($,129);function q(t,n){if(!E(t)||!t.hasOwnProperty("raw"))throw Error("invalid template strings array");return void 0!==O?O.createHTML(n):n}const W=(t,n)=>{const e=t.length-1,i=[];let s,r=2===n?"<svg>":3===n?"<math>":"",o=z;for(let n=0;n<e;n++){const e=t[n];let c,h,u=-1,a=0;for(;a<e.length&&(o.lastIndex=a,h=o.exec(e),null!==h);)a=o.lastIndex,o===z?"!--"===h[1]?o=M:void 0!==h[1]?o=I:void 0!==h[2]?(D.test(h[2])&&(s=RegExp("</"+h[2],"g")),o=P):void 0!==h[3]&&(o=P):o===P?">"===h[0]?(o=s??z,u=-1):void 0===h[1]?u=-2:(u=o.lastIndex-h[2].length,c=h[1],o=void 0===h[3]?P:'"'===h[3]?B:T):o===B||o===T?o=P:o===M||o===I?o=z:(o=P,s=void 0);const l=o===P&&t[n+1].startsWith("/>")?" ":"";r+=o===z?e+A:u>=0?(i.push(c),e.slice(0,u)+j+e.slice(u)+_+l):e+_+(-2===u?n:l)}return[q(t,r+(t[e]||"<?>")+(2===n?"</svg>":3===n?"</math>":"")),i]};class X{constructor({strings:t,_$litType$:n},e){let i;this.parts=[];let s=0,r=0;const o=t.length-1,c=this.parts,[h,u]=W(t,n);if(this.el=X.createElement(h,e),L.currentNode=this.el.content,2===n||3===n){const t=this.el.content.firstChild;t.replaceWith(...t.childNodes)}for(;null!==(i=L.nextNode())&&c.length<o;){if(1===i.nodeType){if(i.hasAttributes())for(const t of i.getAttributeNames())if(t.endsWith(j)){const n=u[r++],e=i.getAttribute(t).split(_),o=/([.?@])?(.*)/.exec(n);c.push({type:1,index:s,name:o[2],strings:e,ctor:"."===o[1]?Q:"?"===o[1]?Y:"@"===o[1]?tt:Z}),i.removeAttribute(t)}else t.startsWith(_)&&(c.push({type:6,index:s}),i.removeAttribute(t));if(D.test(i.tagName)){const t=i.textContent.split(_),n=t.length-1;if(n>0){i.textContent=S?S.emptyScript:"";for(let e=0;e<n;e++)i.append(t[e],C()),L.nextNode(),c.push({type:2,index:++s});i.append(t[n],C())}}}else if(8===i.nodeType)if(i.data===x)c.push({type:2,index:s});else{let t=-1;for(;-1!==(t=i.data.indexOf(_,t+1));)c.push({type:7,index:s}),t+=_.length-1}s++}}static createElement(t,n){const e=$.createElement("template");return e.innerHTML=t,e}}function H(t,n,e=t,i){if(n===R)return n;let s=void 0!==i?e._$Co?.[i]:e._$Cl;const r=N(n)?void 0:n._$litDirective$;return s?.constructor!==r&&(s?._$AO?.(!1),void 0===r?s=void 0:(s=new r(t),s._$AT(t,e,i)),void 0!==i?(e._$Co??=[])[i]=s:e._$Cl=s),void 0!==s&&(n=H(t,s._$AS(t,n.values),s,i)),n}class V{constructor(t,n){this._$AV=[],this._$AN=void 0,this._$AD=t,this._$AM=n}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(t){const{el:{content:n},parts:e}=this._$AD,i=(t?.creationScope??$).importNode(n,!0);L.currentNode=i;let s=L.nextNode(),r=0,o=0,c=e[0];for(;void 0!==c;){if(r===c.index){let n;2===c.type?n=new G(s,s.nextSibling,this,t):1===c.type?n=new c.ctor(s,c.name,c.strings,this,t):6===c.type&&(n=new nt(s,this,t)),this._$AV.push(n),c=e[++o]}r!==c?.index&&(s=L.nextNode(),r++)}return L.currentNode=$,i}p(t){let n=0;for(const e of this._$AV)void 0!==e&&(void 0!==e.strings?(e._$AI(t,e,n),n+=e.strings.length-2):e._$AI(t[n])),n++}}class G{get _$AU(){return this._$AM?._$AU??this._$Cv}constructor(t,n,e,i){this.type=2,this._$AH=F,this._$AN=void 0,this._$AA=t,this._$AB=n,this._$AM=e,this.options=i,this._$Cv=i?.isConnected??!0}get parentNode(){let t=this._$AA.parentNode;const n=this._$AM;return void 0!==n&&11===t?.nodeType&&(t=n.parentNode),t}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(t,n=this){t=H(this,t,n),N(t)?t===F||null==t||""===t?(this._$AH!==F&&this._$AR(),this._$AH=F):t!==this._$AH&&t!==R&&this._(t):void 0!==t._$litType$?this.$(t):void 0!==t.nodeType?this.T(t):(t=>E(t)||"function"==typeof t?.[Symbol.iterator])(t)?this.k(t):this._(t)}O(t){return this._$AA.parentNode.insertBefore(t,this._$AB)}T(t){this._$AH!==t&&(this._$AR(),this._$AH=this.O(t))}_(t){this._$AH!==F&&N(this._$AH)?this._$AA.nextSibling.data=t:this.T($.createTextNode(t)),this._$AH=t}$(t){const{values:n,_$litType$:e}=t,i="number"==typeof e?this._$AC(t):(void 0===e.el&&(e.el=X.createElement(q(e.h,e.h[0]),this.options)),e);if(this._$AH?._$AD===i)this._$AH.p(n);else{const t=new V(i,this),e=t.u(this.options);t.p(n),this.T(e),this._$AH=t}}_$AC(t){let n=K.get(t.strings);return void 0===n&&K.set(t.strings,n=new X(t)),n}k(t){E(this._$AH)||(this._$AH=[],this._$AR());const n=this._$AH;let e,i=0;for(const s of t)i===n.length?n.push(e=new G(this.O(C()),this.O(C()),this,this.options)):e=n[i],e._$AI(s),i++;i<n.length&&(this._$AR(e&&e._$AB.nextSibling,i),n.length=i)}_$AR(t=this._$AA.nextSibling,n){for(this._$AP?.(!1,!0,n);t&&t!==this._$AB;){const n=t.nextSibling;t.remove(),t=n}}setConnected(t){void 0===this._$AM&&(this._$Cv=t,this._$AP?.(t))}}class Z{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(t,n,e,i,s){this.type=1,this._$AH=F,this._$AN=void 0,this.element=t,this.name=n,this._$AM=i,this.options=s,e.length>2||""!==e[0]||""!==e[1]?(this._$AH=Array(e.length-1).fill(new String),this.strings=e):this._$AH=F}_$AI(t,n=this,e,i){const s=this.strings;let r=!1;if(void 0===s)t=H(this,t,n,0),r=!N(t)||t!==this._$AH&&t!==R,r&&(this._$AH=t);else{const i=t;let o,c;for(t=s[0],o=0;o<s.length-1;o++)c=H(this,i[e+o],n,o),c===R&&(c=this._$AH[o]),r||=!N(c)||c!==this._$AH[o],c===F?t=F:t!==F&&(t+=(c??"")+s[o+1]),this._$AH[o]=c}r&&!i&&this.j(t)}j(t){t===F?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,t??"")}}class Q extends Z{constructor(){super(...arguments),this.type=3}j(t){this.element[this.name]=t===F?void 0:t}}class Y extends Z{constructor(){super(...arguments),this.type=4}j(t){this.element.toggleAttribute(this.name,!!t&&t!==F)}}class tt extends Z{constructor(t,n,e,i,s){super(t,n,e,i,s),this.type=5}_$AI(t,n=this){if((t=H(this,t,n,0)??F)===R)return;const e=this._$AH,i=t===F&&e!==F||t.capture!==e.capture||t.once!==e.once||t.passive!==e.passive,s=t!==F&&(e===F||i);i&&this.element.removeEventListener(this.name,this,e),s&&this.element.addEventListener(this.name,this,t),this._$AH=t}handleEvent(t){"function"==typeof this._$AH?this._$AH.call(this.options?.host??this.element,t):this._$AH.handleEvent(t)}}class nt{constructor(t,n,e){this.element=t,this.type=6,this._$AN=void 0,this._$AM=n,this.options=e}get _$AU(){return this._$AM._$AU}_$AI(t){H(this,t)}}const et=k.litHtmlPolyfillSupport;et?.(X,G),(k.litHtmlVersions??=[]).push("3.3.0");const it=globalThis;
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */class st extends v{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){const t=super.createRenderRoot();return this.renderOptions.renderBefore??=t.firstChild,t}update(t){const n=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(t),this._$Do=((t,n,e)=>{const i=e?.renderBefore??n;let s=i._$litPart$;if(void 0===s){const t=e?.renderBefore??null;i._$litPart$=s=new G(n.insertBefore(C(),t),t,void 0,e??{})}return s._$AI(t),s})(n,this.renderRoot,this.renderOptions)}connectedCallback(){super.connectedCallback(),this._$Do?.setConnected(!0)}disconnectedCallback(){super.disconnectedCallback(),this._$Do?.setConnected(!1)}render(){return R}}st._$litElement$=!0,st.finalized=!0,it.litElementHydrateSupport?.({LitElement:st});const rt=it.litElementPolyfillSupport;rt?.({LitElement:st}),(it.litElementVersions??=[]).push("4.2.0");
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */
const ot={attribute:!0,type:String,converter:g,reflect:!1,hasChanged:b},ct=(t=ot,n,e)=>{const{kind:i,metadata:s}=e;let r=globalThis.litPropertyMetadata.get(s);if(void 0===r&&globalThis.litPropertyMetadata.set(s,r=new Map),"setter"===i&&((t=Object.create(t)).wrapped=!0),r.set(e.name,t),"accessor"===i){const{name:i}=e;return{set(e){const s=n.get.call(this);n.set.call(this,e),this.requestUpdate(i,s,t)},init(n){return void 0!==n&&this.C(i,void 0,t,n),n}}}if("setter"===i){const{name:i}=e;return function(e){const s=this[i];n.call(this,e),this.requestUpdate(i,s,t)}}throw Error("Unsupported decorator location: "+i)};
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */function ht(t){return(n,e)=>"object"==typeof e?ct(t,n,e):((t,n,e)=>{const i=n.hasOwnProperty(e);return n.constructor.createProperty(e,t),i?Object.getOwnPropertyDescriptor(n,e):void 0})(t,n,e)
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */}function ut(t){return null===t?"null":t!==Object(t)?typeof t:{}.toString.call(t).slice(8,-1).toLowerCase()}function at(t){return"string"!==ut(t)||!t.length}function lt(t="",n,e){if(at(t))return!1;const i=t.charCodeAt(0);return n<=i&&i<=e}const ft="toHiragana",dt="toKatakana",pt="hepburn",wt={useObsoleteKana:!1,passRomaji:!1,convertLongVowelMark:!0,upcaseKatakana:!1,IMEMode:!1,romanization:pt},yt=12353,gt=12449,bt=[65377,65381],mt=[...[[12352,12447],[12448,12543],bt,[65382,65439]],...[[12288,12351],bt,[12539,12540],[65281,65295],[65306,65311],[65339,65343],[65371,65376],[65504,65518]],[65313,65338],[65345,65370],[65296,65305],[19968,40959],[13312,19903]],vt=[[0,127],[256,257],[274,275],[298,299],[332,333],[362,363]],kt=[[32,47],[58,63],[91,96],[123,126],[8216,8217],[8220,8221]];function St(t="",n){const e="regexp"===ut(n);return!at(t)&&[...t].every((t=>{const i=function(t=""){return mt.some((([n,e])=>lt(t,n,e)))}(t);return e?i||n.test(t):i}))}var Ot=Number.isNaN||function(t){return"number"==typeof t&&t!=t};function jt(t,n){if(t.length!==n.length)return!1;for(var e=0;e<t.length;e++)if(i=t[e],s=n[e],!(i===s||Ot(i)&&Ot(s)))return!1;var i,s;return!0}function _t(t,n){void 0===n&&(n=jt);var e=null;function i(){for(var i=[],s=0;s<arguments.length;s++)i[s]=arguments[s];if(e&&e.lastThis===this&&n(i,e.lastArgs))return e.lastResult;var r=t.apply(this,i);return e={lastResult:r,lastArgs:i,lastThis:this},r}return i.clear=function(){e=null},i}var xt=Object.prototype.hasOwnProperty;function At(t,n,e){for(e of t.keys())if($t(e,n))return e}function $t(t,n){var e,i,s;if(t===n)return!0;if(t&&n&&(e=t.constructor)===n.constructor){if(e===Date)return t.getTime()===n.getTime();if(e===RegExp)return t.toString()===n.toString();if(e===Array){if((i=t.length)===n.length)for(;i--&&$t(t[i],n[i]););return-1===i}if(e===Set){if(t.size!==n.size)return!1;for(i of t){if((s=i)&&"object"==typeof s&&!(s=At(n,s)))return!1;if(!n.has(s))return!1}return!0}if(e===Map){if(t.size!==n.size)return!1;for(i of t){if((s=i[0])&&"object"==typeof s&&!(s=At(n,s)))return!1;if(!$t(i[1],n.get(s)))return!1}return!0}if(e===ArrayBuffer)t=new Uint8Array(t),n=new Uint8Array(n);else if(e===DataView){if((i=t.byteLength)===n.byteLength)for(;i--&&t.getInt8(i)===n.getInt8(i););return-1===i}if(ArrayBuffer.isView(t)){if((i=t.byteLength)===n.byteLength)for(;i--&&t[i]===n[i];);return-1===i}if(!e||"object"==typeof t){for(e in i=0,t){if(xt.call(t,e)&&++i&&!xt.call(n,e))return!1;if(!(e in n)||!$t(t[e],n[e]))return!1}return Object.keys(n).length===i}}return t!=t&&n!=n}const Ct=(t={})=>Object.assign({},wt,t);function Nt(t,n,e){const i=n;function s(t,n){const e=t.charAt(0);return r(Object.assign({"":e},i[e]),t.slice(1),n,n+1)}function r(t,n,i,o){if(!n)return e||1===Object.keys(t).length?t[""]?[[i,o,t[""]]]:[]:[[i,o,null]];if(1===Object.keys(t).length)return[[i,o,t[""]]].concat(s(n,o));const c=function(t,n){if(void 0!==t[n])return Object.assign({"":t[""]+n},t[n])}(t,n.charAt(0));return void 0===c?[[i,o,t[""]]].concat(s(n,o)):r(c,n.slice(1),i,o+1)}return s(t,0)}function Et(t){return Object.entries(t).reduce(((t,[n,e])=>{const i="string"===ut(e);return t[n]=i?{"":e}:Et(e),t}),{})}function Ut(t,n){return n.split("").reduce(((t,n)=>(void 0===t[n]&&(t[n]={}),t[n])),t)}function zt(t={}){const n={};return"object"===ut(t)&&Object.entries(t).forEach((([t,e])=>{let i=n;t.split("").forEach((t=>{void 0===i[t]&&(i[t]={}),i=i[t]})),i[""]=e})),function(t){return function t(n,e){return void 0===n||"string"===ut(n)?e:Object.entries(e).reduce(((e,[i,s])=>(e[i]=t(n[i],s),e)),n)}(JSON.parse(JSON.stringify(t)),n)}}function Mt(t,n){return n?"function"===ut(n)?n(t):zt(n)(t):t}const It={a:"あ",i:"い",u:"う",e:"え",o:"お",k:{a:"か",i:"き",u:"く",e:"け",o:"こ"},s:{a:"さ",i:"し",u:"す",e:"せ",o:"そ"},t:{a:"た",i:"ち",u:"つ",e:"て",o:"と"},n:{a:"な",i:"に",u:"ぬ",e:"ね",o:"の"},h:{a:"は",i:"ひ",u:"ふ",e:"へ",o:"ほ"},m:{a:"ま",i:"み",u:"む",e:"め",o:"も"},y:{a:"や",u:"ゆ",o:"よ"},r:{a:"ら",i:"り",u:"る",e:"れ",o:"ろ"},w:{a:"わ",i:"ゐ",e:"ゑ",o:"を"},g:{a:"が",i:"ぎ",u:"ぐ",e:"げ",o:"ご"},z:{a:"ざ",i:"じ",u:"ず",e:"ぜ",o:"ぞ"},d:{a:"だ",i:"ぢ",u:"づ",e:"で",o:"ど"},b:{a:"ば",i:"び",u:"ぶ",e:"べ",o:"ぼ"},p:{a:"ぱ",i:"ぴ",u:"ぷ",e:"ぺ",o:"ぽ"},v:{a:"ゔぁ",i:"ゔぃ",u:"ゔ",e:"ゔぇ",o:"ゔぉ"}},Pt={".":"。",",":"、",":":"：","/":"・","!":"！","?":"？","~":"〜","-":"ー","‘":"「","’":"」","“":"『","”":"』","[":"［","]":"］","(":"（",")":"）","{":"｛","}":"｝"},Tt={k:"き",s:"し",t:"ち",n:"に",h:"ひ",m:"み",r:"り",g:"ぎ",z:"じ",d:"ぢ",b:"び",p:"ぴ",v:"ゔ",q:"く",f:"ふ"},Bt={ya:"ゃ",yi:"ぃ",yu:"ゅ",ye:"ぇ",yo:"ょ"},Dt={a:"ぁ",i:"ぃ",u:"ぅ",e:"ぇ",o:"ぉ"},Jt={sh:"sy",ch:"ty",cy:"ty",chy:"ty",shy:"sy",j:"zy",jy:"zy",shi:"si",chi:"ti",tsu:"tu",ji:"zi",fu:"hu"},Rt=Object.assign({tu:"っ",wa:"ゎ",ka:"ヵ",ke:"ヶ"},Dt,Bt),Ft={yi:"い",wu:"う",ye:"いぇ",wi:"うぃ",we:"うぇ",kwa:"くぁ",whu:"う",tha:"てゃ",thu:"てゅ",tho:"てょ",dha:"でゃ",dhu:"でゅ",dho:"でょ"},Kt={wh:"う",kw:"く",qw:"く",q:"く",gw:"ぐ",sw:"す",ts:"つ",th:"て",tw:"と",dh:"で",dw:"ど",fw:"ふ",f:"ふ"};function Lt(){const t=Et(It),n=n=>Ut(t,n);function e(t){return Object.entries(t).reduce(((t,[n,i])=>(t[n]=n?e(i):`っ${i}`,t)),{})}return Object.entries(Tt).forEach((([t,e])=>{Object.entries(Bt).forEach((([i,s])=>{n(t+i)[""]=e+s}))})),Object.entries(Pt).forEach((([t,e])=>{n(t)[""]=e})),Object.entries(Kt).forEach((([t,e])=>{Object.entries(Dt).forEach((([i,s])=>{n(t+i)[""]=e+s}))})),["n","n'","xn"].forEach((t=>{n(t)[""]="ん"})),t.c=JSON.parse(JSON.stringify(t.k)),Object.entries(Jt).forEach((([t,e])=>{const i=t.slice(0,t.length-1),s=t.charAt(t.length-1);n(i)[s]=JSON.parse(JSON.stringify(n(e)))})),Object.entries(Rt).forEach((([t,e])=>{const i=t=>t.charAt(t.length-1),s=t=>t.slice(0,t.length-1),r=n(`x${t}`);r[""]=e;var o;n(`l${s(t)}`)[i(t)]=r,(o=t,[...Object.entries(Jt),["c","k"]].reduce(((t,[n,e])=>o.startsWith(e)?t.concat(o.replace(e,n)):t),[])).forEach((e=>{["l","x"].forEach((r=>{n(r+s(e))[i(e)]=n(r+t)}))}))})),Object.entries(Ft).forEach((([t,e])=>{n(t)[""]=e})),[...Object.keys(Tt),"c","y","w","j"].forEach((n=>{const i=t[n];i[n]=e(i)})),delete t.n.n,Object.freeze(JSON.parse(JSON.stringify(t)))}let qt=null;const Wt=zt({wi:"ゐ",we:"ゑ"});function Xt(t=""){return!at(t)&&lt(t,65,90)}function Ht(t=""){return!at(t)&&12540===t.charCodeAt(0)}function Vt(t=""){return!at(t)&&12539===t.charCodeAt(0)}function Gt(t=""){return!at(t)&&(!!Ht(t)||lt(t,yt,12438))}function Zt(t=""){const n=[];return t.split("").forEach((t=>{if(Ht(t)||Vt(t))n.push(t);else if(Gt(t)){const e=t.charCodeAt(0)+96,i=String.fromCharCode(e);n.push(i)}else n.push(t)})),n.join("")}const Qt=_t(((t,n,e)=>{let i=(null==qt&&(qt=Lt()),qt);return i=t?function(t){const n=JSON.parse(JSON.stringify(t));return n.n.n={"":"ん"},n.n[" "]={"":"ん"},n}(i):i,i=n?Wt(i):i,e&&(i=Mt(i,e)),i}),$t);function Yt(t="",n={},e){let i;return e?i=n:(i=Ct(n),e=Qt(i.IMEMode,i.useObsoleteKana,i.customKanaMapping)),function(t="",n={},e){const{IMEMode:i,useObsoleteKana:s,customKanaMapping:r}=n;e||(e=Qt(i,s,r));return Nt(t.toLowerCase(),e,!i)}(t,i,e).map((n=>{const[e,s,r]=n;if(null===r)return t.slice(e);const o=i.IMEMode===ft,c=i.IMEMode===dt||[...t.slice(e,s)].every(Xt);return o||!c?r:Zt(r)})).join("")}let tn=[];function nn(t){const n=Object.assign({},Ct(t),{IMEMode:t.IMEMode||!0}),e=Qt(n.IMEMode,n.useObsoleteKana,n.customKanaMapping),i=[...Object.keys(e),...Object.keys(e).map((t=>t.toUpperCase()))];return function({target:t}){undefined!==t.value&&"true"!==t.dataset.ignoreComposition&&function(t,n,e,i){const[s,r,o]=function(t="",n=0,e=[]){let i,s,r;0===n&&e.includes(t[0])?[i,s,r]=function(t,n){return["",...sn(t,(t=>n.includes(t)||!St(t,/[0-9]/)))]}(t,e):n>0?[i,s,r]=function(t="",n=0){const[e,i]=sn([...t.slice(0,n)].reverse(),(t=>!St(t)));return[i.reverse().join(""),e.split("").reverse().join(""),t.slice(n)]}(t,n):([i,s]=sn(t,(t=>!e.includes(t))),[s,r]=sn(s,(t=>!St(t))));return[i,s,r]}(t.value,t.selectionEnd,i),c=Yt(r,n,e);if(r!==c){const n=s.length+c.length,e=s+c+o;t.value=e,o.length?setTimeout((()=>t.setSelectionRange(n,n)),1):t.setSelectionRange(n,n)}else t.value}(t,n,e,i)}}function en({type:t,target:n,data:e}){/Mac/.test(window.navigator&&window.navigator.platform)&&("compositionupdate"===t&&St(e)&&(n.dataset.ignoreComposition="true"),"compositionend"===t&&(n.dataset.ignoreComposition="false"))}function sn(t={},n=t=>!!t){const e=[],{length:i}=t;let s=0;for(;s<i&&n(t[s],s);)e.push(t[s]),s+=1;return[e.join(""),t.slice(s)]}const rn={input:({target:{value:t,selectionStart:n,selectionEnd:e}})=>console.log("input:",{value:t,selectionStart:n,selectionEnd:e}),compositionstart:()=>console.log("compositionstart"),compositionupdate:({target:{value:t,selectionStart:n,selectionEnd:e},data:i})=>console.log("compositionupdate",{data:i,value:t,selectionStart:n,selectionEnd:e}),compositionend:()=>console.log("compositionend")},on=["TEXTAREA","INPUT"];let cn=0;function hn(t={},n={},e=!1){if(!on.includes(t.nodeName))throw new Error(`Element provided to Wanakana bind() was not a valid input or textarea element.\n Received: (${JSON.stringify(t)})`);if(t.hasAttribute("data-wanakana-id"))return;const i=nn(n),s=(cn+=1,`${Date.now()}${cn}`),r={};var o;[{name:"data-wanakana-id",value:s},{name:"lang",value:"ja"},{name:"autoCapitalize",value:"none"},{name:"autoCorrect",value:"off"},{name:"autoComplete",value:"off"},{name:"spellCheck",value:"false"}].forEach((n=>{r[n.name]=t.getAttribute(n.name),t.setAttribute(n.name,n.value)})),t.dataset.previousAttributes=JSON.stringify(r),t.addEventListener("input",i),t.addEventListener("compositionupdate",en),t.addEventListener("compositionend",en),function(t,n,e){tn=tn.concat({id:t,inputHandler:n,compositionHandler:e})}(s,i,en),!0===e&&(o=t,Object.entries(rn).forEach((([t,n])=>o.addEventListener(t,n))))}function un(t="",n){const e="regexp"===ut(n);return!at(t)&&[...t].every((t=>{const i=function(t=""){return!at(t)&&vt.some((([n,e])=>lt(t,n,e)))}(t);return e?i||n.test(t):i}))}function an(t=""){return lt(t,gt,12540)}function ln(t=""){return!at(t)&&[...t].every(Gt)}function fn(t=""){return!at(t)&&[...t].every(an)}function dn(t=""){return lt(t,19968,40879)||function(t=""){return!at(t)&&12293===t.charCodeAt(0)}(t)}function pn(t=""){return!at(t)&&[...t].every(dn)}function wn(t="",n={passKanji:!0}){const e=[...t];let i=!1;return n.passKanji||(i=e.some(pn)),(e.some(ln)||e.some(fn))&&e.some(un)&&!i}const yn={a:"あ",i:"い",u:"う",e:"え",o:"う"};function gn(t="",n,{isDestinationRomaji:e,convertLongVowelMark:i}={}){let s="";return t.split("").reduce(((r,o,c)=>{if(Vt(o)||((t,n)=>Ht(t)&&n<1)(o,c)||(t=>["ヶ","ヵ"].includes(t))(o))return r.concat(o);if(i&&s&&((t,n)=>Ht(t)&&n>0)(o,c)){const i=n(s).slice(-1);return an(t[c-1])&&"o"===i&&e?r.concat("お"):r.concat(yn[i])}if(!Ht(o)&&an(o)){const t=o.charCodeAt(0)+-96,n=String.fromCharCode(t);return s=n,r.concat(n)}return s="",r.concat(o)}),[]).join("")}let bn=null;const mn={あ:"a",い:"i",う:"u",え:"e",お:"o",か:"ka",き:"ki",く:"ku",け:"ke",こ:"ko",さ:"sa",し:"shi",す:"su",せ:"se",そ:"so",た:"ta",ち:"chi",つ:"tsu",て:"te",と:"to",な:"na",に:"ni",ぬ:"nu",ね:"ne",の:"no",は:"ha",ひ:"hi",ふ:"fu",へ:"he",ほ:"ho",ま:"ma",み:"mi",む:"mu",め:"me",も:"mo",ら:"ra",り:"ri",る:"ru",れ:"re",ろ:"ro",や:"ya",ゆ:"yu",よ:"yo",わ:"wa",ゐ:"wi",ゑ:"we",を:"wo",ん:"n",が:"ga",ぎ:"gi",ぐ:"gu",げ:"ge",ご:"go",ざ:"za",じ:"ji",ず:"zu",ぜ:"ze",ぞ:"zo",だ:"da",ぢ:"ji",づ:"zu",で:"de",ど:"do",ば:"ba",び:"bi",ぶ:"bu",べ:"be",ぼ:"bo",ぱ:"pa",ぴ:"pi",ぷ:"pu",ぺ:"pe",ぽ:"po",ゔぁ:"va",ゔぃ:"vi",ゔ:"vu",ゔぇ:"ve",ゔぉ:"vo"},vn={"。":".","、":",","：":":","・":"/","！":"!","？":"?","〜":"~",ー:"-","「":"‘","」":"’","『":"“","』":"”","［":"[","］":"]","（":"(","）":")","｛":"{","｝":"}","　":" "},kn=["あ","い","う","え","お","や","ゆ","よ"],Sn={ゃ:"ya",ゅ:"yu",ょ:"yo"},On={ぃ:"yi",ぇ:"ye"},jn={ぁ:"a",ぃ:"i",ぅ:"u",ぇ:"e",ぉ:"o"},_n=["き","に","ひ","み","り","ぎ","び","ぴ","ゔ","く","ふ"],xn={し:"sh",ち:"ch",じ:"j",ぢ:"j"},An={っ:"",ゃ:"ya",ゅ:"yu",ょ:"yo",ぁ:"a",ぃ:"i",ぅ:"u",ぇ:"e",ぉ:"o"},$n={b:"b",c:"t",d:"d",f:"f",g:"g",h:"h",j:"j",k:"k",m:"m",p:"p",q:"q",r:"r",s:"s",t:"t",v:"v",w:"w",x:"x",z:"z"};function Cn(){return null==bn&&(bn=function(){const t=Et(mn),n=n=>Ut(t,n),e=(t,e)=>{n(t)[""]=e};return Object.entries(vn).forEach((([t,e])=>{n(t)[""]=e})),[...Object.entries(Sn),...Object.entries(jn)].forEach((([t,n])=>{e(t,n)})),_n.forEach((t=>{const i=n(t)[""][0];Object.entries(Sn).forEach((([n,s])=>{e(t+n,i+s)})),Object.entries(On).forEach((([n,s])=>{e(t+n,i+s)}))})),Object.entries(xn).forEach((([t,n])=>{Object.entries(Sn).forEach((([i,s])=>{e(t+i,n+s[1])})),e(`${t}ぃ`,`${n}yi`),e(`${t}ぇ`,`${n}e`)})),t["っ"]=Nn(t),Object.entries(An).forEach((([t,n])=>{e(t,n)})),kn.forEach((t=>{e(`ん${t}`,`n'${n(t)[""]}`)})),Object.freeze(JSON.parse(JSON.stringify(t)))}()),bn}function Nn(t){return Object.entries(t).reduce(((t,[n,e])=>{if(n)t[n]=Nn(e);else{const i=e.charAt(0);t[n]=Object.keys($n).includes(i)?$n[i]+e:e}return t}),{})}const En=_t(((t,n)=>{let e=function(t){return t===pt?Cn():{}}(t);return n&&(e=Mt(e,n)),e}),$t);function Un(t="",n={},e){const i=Ct(n);return e||(e=En(i.romanization,i.customRomajiMapping)),function(t,n,e){e||(e=En(n.romanization,n.customRomajiMapping));const i=Object.assign({},{isDestinationRomaji:!0},n);return Nt(gn(t,Un,i),e,!n.IMEMode)}(t,i,e).map((n=>{const[e,s,r]=n;return i.upcaseKatakana&&fn(t.slice(e,s))?r.toUpperCase():r})).join("")}function zn(t=""){return!at(t)&&kt.some((([n,e])=>lt(t,n,e)))}function Mn(t="",n={}){const e=Ct(n);if(e.passRomaji)return gn(t,Un,e);if(wn(t,{passKanji:!0})){return Yt(gn(t,Un,e).toLowerCase(),e)}return un(t)||zn(t)?Yt(t.toLowerCase(),e):gn(t,Un,e)}var In=class{start_pos;length;name;cost;left_id;right_id;prev;surface_form;shortest_cost;type;constructor(t,n,e,i,s,r,o,c){this.name=t,this.cost=n,this.start_pos=e,this.length=i,this.left_id=r,this.right_id=o,this.prev=null,this.surface_form=c,this.shortest_cost="BOS"===s?0:Number.MAX_VALUE,this.type=s}},Pn=class{nodes_end_at;eos_pos;constructor(){this.nodes_end_at=[],this.nodes_end_at[0]=[new In(-1,0,0,0,"BOS",0,0,"")],this.eos_pos=1}append(t){const n=t.start_pos+t.length-1;this.eos_pos<n&&(this.eos_pos=n);let e=this.nodes_end_at[n];null==e&&(e=[]),e.push(t),this.nodes_end_at[n]=e}appendEos(){const t=this.nodes_end_at.length;this.eos_pos++,this.nodes_end_at[t]=[new In(-1,0,this.eos_pos,0,"EOS",0,0,"")]}},Tn=class t{length;str;index_mapping;constructor(n){this.str=n,this.index_mapping=[];for(let e=0;e<n.length;e++){const i=n.charAt(e);this.index_mapping.push(e),t.isSurrogatePair(i)&&e++}this.length=this.index_mapping.length}slice(t){if(this.index_mapping.length<=t)return"";const n=this.index_mapping[t];return this.str.slice(n)}charAt(t){if(this.str.length<=t)return"";const n=this.index_mapping[t],e=this.index_mapping[t+1];return null==e?this.str.slice(n):this.str.slice(n,e)}charCodeAt(t){if(this.index_mapping.length<=t)return NaN;const n=this.index_mapping[t],e=this.str.charCodeAt(n);let i;return e>=55296&&e<=56319&&n<this.str.length&&(i=this.str.charCodeAt(n+1),i>=56320&&i<=57343)?1024*(e-55296)+i-56320+65536:e}toString(){return this.str}static isSurrogatePair(t){const n=t.charCodeAt(0);return n>=55296&&n<=56319}},Bn=class{trie;token_info_dictionary;unknown_dictionary;constructor(t){this.trie=t.trie,this.token_info_dictionary=t.token_info_dictionary,this.unknown_dictionary=t.unknown_dictionary}build(t){const n=new Pn,e=new Tn(t);let i,s,r,o,c;for(let t=0;t<e.length;t++){const h=e.slice(t),u=this.trie.commonPrefixSearch(h);for(let e=0;e<u.length;e++){s=u[e].v,i=u[e].k;const h=this.token_info_dictionary.target_map[s];for(let e=0;e<h.length;e++){const s=parseInt(h[e]);r=this.token_info_dictionary.dictionary.getShort(s),o=this.token_info_dictionary.dictionary.getShort(s+2),c=this.token_info_dictionary.dictionary.getShort(s+4),n.append(new In(s,c,t+1,i.length,"KNOWN",r,o,i))}}const a=new Tn(h),l=new Tn(a.charAt(0)),f=this.unknown_dictionary.lookup(l.toString());if(!f)throw new Error("Unknown character: "+l);if(null==u||0===u.length||1===f.is_always_invoke){if(i=l,1===f.is_grouping&&1<a.length)for(let t=1;t<a.length;t++){const n=a.charAt(t),e=this.unknown_dictionary.lookup(n);if(f.class_name!==e.class_name)break;i+=n}const e=this.unknown_dictionary.target_map[f.class_id];for(let s=0;s<e.length;s++){const h=parseInt(e[s]);r=this.unknown_dictionary.dictionary.getShort(h),o=this.unknown_dictionary.dictionary.getShort(h+2),c=this.unknown_dictionary.dictionary.getShort(h+4),n.append(new In(h,c,t+1,i.length,"UNKNOWN",r,o,i.toString()))}}}return n.appendEos(),n}},Dn=class{connection_costs;constructor(t){this.connection_costs=t}search(t){return t=this.forward(t),this.backward(t)}forward(t){let n,e,i;for(n=1;n<=t.eos_pos;n++){const s=t.nodes_end_at[n];if(null!=s)for(e=0;e<s.length;e++){const n=s[e];let r=Number.MAX_VALUE,o=null;const c=t.nodes_end_at[n.start_pos-1];if(null!=c){for(i=0;i<c.length;i++){const t=c[i];let e;null==n.left_id||null==t.right_id?(console.log("Left or right is null"),e=0):e=this.connection_costs.get(t.right_id,n.left_id);const s=t.shortest_cost+e+n.cost;s<r&&(o=t,r=s)}n.prev=o,n.shortest_cost=r}}}return t}backward(t){const n=[];let e=t.nodes_end_at[t.nodes_end_at.length-1][0].prev;if(null==e)return[];for(;"BOS"!==e.type;){if(n.push(e),null==e.prev)return[];e=e.prev}return n.reverse()}},Jn=class{formatEntry(t,n,e,i){const s={};return s.word_id=t,s.word_type=e,s.word_position=n,s.surface_form=i[0],s.pos=i[1],s.pos_detail_1=i[2],s.pos_detail_2=i[3],s.pos_detail_3=i[4],s.conjugated_type=i[5],s.conjugated_form=i[6],s.basic_form=i[7],s.reading=i[8],s.pronunciation=i[9],s}formatUnknownEntry(t,n,e,i,s){const r={};return r.word_id=t,r.word_type=e,r.word_position=n,r.surface_form=s,r.pos=i[1],r.pos_detail_1=i[2],r.pos_detail_2=i[3],r.pos_detail_3=i[4],r.conjugated_type=i[5],r.conjugated_form=i[6],r.basic_form=i[7],r}},Rn=/、|。/,Fn=class t{token_info_dictionary;unknown_dictionary;viterbi_builder;viterbi_searcher;formatter;constructor(t){this.token_info_dictionary=t.token_info_dictionary,this.unknown_dictionary=t.unknown_dictionary,this.viterbi_builder=new Bn(t),this.viterbi_searcher=new Dn(t.connection_costs),this.formatter=new Jn}tokenize(n){const e=t.splitByPunctuation(n),i=[];for(let t=0;t<e.length;t++){const n=e[t];this.tokenizeForSentence(n,i)}return i}tokenizeForSentence(t,n){null==n&&(n=[]);const e=this.getLattice(t),i=this.viterbi_searcher.search(e);let s=0;n.length>0&&(s=n[n.length-1].word_position);for(let t=0;t<i.length;t++){const e=i[t];let r,o,c;"KNOWN"===e.type?(c=this.token_info_dictionary.getFeatures(e.name),o=null==c?[]:c.split(","),r=this.formatter.formatEntry(e.name,s+e.start_pos,e.type,o)):"UNKNOWN"===e.type?(c=this.unknown_dictionary.getFeatures(e.name),o=null==c?[]:c.split(","),r=this.formatter.formatUnknownEntry(e.name,s+e.start_pos,e.type,o,e.surface_form)):r=this.formatter.formatEntry(e.name,s+e.start_pos,e.type,[]),n.push(r)}return n}getLattice(t){return this.viterbi_builder.build(t)}static splitByPunctuation(t){const n=[];let e=t;for(;""!==e;){const t=e.search(Rn);if(t<0){n.push(e);break}n.push(e.substring(0,t+1)),e=e.substring(t+1)}return n}},Kn=-1,Ln=!0,qn=!0,Wn=function(t){null==t&&(t=1024);let n=function(t,n,e){for(let i=n;i<e;i++)t[i]=1-i;if(0<o.array[o.array.length-1]){let e=o.array.length-2;for(;0<o.array[e];)e--;t[n]=-e}},e=function(t,n,e){for(let i=n;i<e;i++)t[i]=-i-1},i=function(t){let i=2*t,s=Vn(r.signed,r.bytes,i);n(s,r.array.length,i),s.set(r.array),r.array=null,r.array=s;let c=Vn(o.signed,o.bytes,i);e(c,o.array.length,i),c.set(o.array),o.array=null,o.array=c},s=1;var r={signed:Ln,bytes:4,array:Vn(Ln,4,t)},o={signed:qn,bytes:4,array:Vn(qn,4,t)};return r.array[0]=1,o.array[0]=0,n(r.array,1,r.array.length),e(o.array,1,o.array.length),{getBaseBuffer:function(){return r.array},getCheckBuffer:function(){return o.array},loadBaseBuffer:function(t){return r.array=t,this},loadCheckBuffer:function(t){return o.array=t,this},size:function(){return Math.max(r.array.length,o.array.length)},getBase:function(t){return r.array.length-1<t?1-t:r.array[t]},getCheck:function(t){return o.array.length-1<t?-t-1:o.array[t]},setBase:function(t,n){r.array.length-1<t&&i(t),r.array[t]=n},setCheck:function(t,n){o.array.length-1<t&&i(t),o.array[t]=n},setFirstUnusedNode:function(t){s=t},getFirstUnusedNode:function(){return s},shrink:function(){let t=this.size()-1;for(;!(0<=o.array[t]);)t--;r.array=r.array.subarray(0,t+2),o.array=o.array.subarray(0,t+2)},calc:function(){let t=0,n=o.array.length;for(let e=0;e<n;e++)o.array[e]<0&&t++;return{all:n,unused:t,efficiency:(n-t)/n}},dump:function(){let t,n="",e="";for(t=0;t<r.array.length;t++)n=n+" "+this.getBase(t);for(t=0;t<o.array.length;t++)e=e+" "+this.getCheck(t);return console.log("base:"+n),console.log("chck:"+e),"base:"+n+" chck:"+e}}};function Xn(t){this.bc=Wn(t),this.keys=[]}function Hn(t){this.bc=t,this.bc.shrink()}Xn.prototype.append=function(t,n){return this.keys.push({k:t,v:n}),this},Xn.prototype.build=function(t,n){if(null==t&&(t=this.keys),null==t)return new Hn(this.bc);null==n&&(n=!1);let e=t.map((function(t){return{k:Zn(t.k+"\0"),v:t.v}}));return this.keys=n?e:e.sort((function(t,n){const e=t.k,i=n.k,s=Math.min(e.length,i.length);for(let t=0;t<s;t++)if(e[t]!==i[t])return e[t]-i[t];return e.length-i.length})),e=null,this._build(0,0,0,this.keys.length),new Hn(this.bc)},Xn.prototype._build=function(t,n,e,i){const s=this.getChildrenInfo(n,e,i),r=this.findAllocatableBase(s);this.setBC(t,s,r);for(let t=0;t<s.length;t+=3){const e=s[t];if(0===e)continue;const i=s[t+1],o=s[t+2],c=r+e;this._build(c,n+1,i,o)}},Xn.prototype.getChildrenInfo=function(t,n,e){let i=this.keys[n].k[t],s=0,r=new Int32Array(3*e);r[s++]=i,r[s++]=n;let o=n,c=n;for(;o<n+e;o++){const n=this.keys[o].k[t];i!==n&&(r[s++]=o-c,r[s++]=n,r[s++]=o,i=n,c=o)}return r[s++]=o-c,r=r.subarray(0,s),r},Xn.prototype.setBC=function(t,n,e){const i=this.bc;let s;for(i.setBase(t,e),s=0;s<n.length;s+=3){const r=n[s],o=e+r,c=-i.getBase(o),h=-i.getCheck(o);o!==i.getFirstUnusedNode()?i.setCheck(c,-h):i.setFirstUnusedNode(h),i.setBase(h,-c);const u=t;if(i.setCheck(o,u),0===r){const t=n[s+1];let e=this.keys[t].v;null==e&&(e=0);const r=-e-1;i.setBase(o,r)}}},Xn.prototype.findAllocatableBase=function(t){const n=this.bc;let e,i=n.getFirstUnusedNode();for(;;){if(e=i-t[0],e<0){i=-n.getCheck(i);continue}let s=!0;for(let r=0;r<t.length;r+=3){const o=e+t[r];if(!this.isUnusedNode(o)){i=-n.getCheck(i),s=!1;break}}if(s)return e}},Xn.prototype.isUnusedNode=function(t){const n=this.bc.getCheck(t);return 0!==t&&n<0},Hn.prototype.contain=function(t){const n=this.bc,e=Zn(t+="\0");let i=0,s=Kn;for(let t=0;t<e.length;t++){const r=e[t];if(s=this.traverse(i,r),s===Kn)return!1;if(n.getBase(s)<=0)return!0;i=s}return!1},Hn.prototype.lookup=function(t){const n=Zn(t+="\0");let e=0,i=Kn;for(let t=0;t<n.length;t++){const s=n[t];if(i=this.traverse(e,s),i===Kn)return Kn;e=i}const s=this.bc.getBase(i);return s<=0?-s-1:Kn},Hn.prototype.commonPrefixSearch=function(t){const n=Zn(t);let e=0,i=Kn;const s=[];for(let t=0;t<n.length;t++){const r=n[t];if(i=this.traverse(e,r),i===Kn)break;{e=i;const r=this.traverse(i,0);if(r!==Kn){const e=this.bc.getBase(r),i={};e<=0&&(i.v=-e-1),i.k=Qn(Gn(n,0,t+1)),s.push(i)}}}return s},Hn.prototype.traverse=function(t,n){const e=this.bc.getBase(t)+n;return this.bc.getCheck(e)===t?e:Kn},Hn.prototype.size=function(){return this.bc.size()},Hn.prototype.calc=function(){return this.bc.calc()},Hn.prototype.dump=function(){return this.bc.dump()};var Vn=function(t,n,e){switch(n){case 1:return new Int8Array(e);case 2:return new Int16Array(e);case 4:return new Int32Array(e);default:throw new RangeError("Invalid newArray parameter element_bytes:"+n)}},Gn=function(t,n,e){const i=new ArrayBuffer(e),s=new Uint8Array(i,0,e),r=t.subarray(n,e);return s.set(r),s},Zn=function(t){const n=new Uint8Array(new ArrayBuffer(4*t.length));let e=0,i=0;for(;e<t.length;){var s;const r=t.charCodeAt(e++);if(r>=55296&&r<=56319){const n=r,i=t.charCodeAt(e++);if(!(i>=56320&&i<=57343))return null;s=1024*(n-55296)+65536+(i-56320)}else s=r;s<128?n[i++]=s:s<2048?(n[i++]=s>>>6|192,n[i++]=63&s|128):s<65536?(n[i++]=s>>>12|224,n[i++]=s>>6&63|128,n[i++]=63&s|128):s<1<<21&&(n[i++]=s>>>18|240,n[i++]=s>>12&63|128,n[i++]=s>>6&63|128,n[i++]=63&s|128)}return n.subarray(0,i)},Qn=function(t){let n,e,i,s,r,o,c,h="",u=0;for(;u<t.length;)e=t[u++],e<128?n=e:e>>5==6?(i=t[u++],n=(31&e)<<6|63&i):e>>4==14?(i=t[u++],s=t[u++],n=(15&e)<<12|(63&i)<<6|63&s):(i=t[u++],s=t[u++],r=t[u++],n=(7&e)<<18|(63&i)<<12|(63&s)<<6|63&r),n<65536?h+=String.fromCharCode(n):(n-=65536,o=55296|n>>10,c=56320|1023&n,h+=String.fromCharCode(o,c));return h};var Yn=class{buffer;position;constructor(t){let n;if(null==t)n=1048576;else{if("number"!=typeof t){if(t instanceof Uint8Array)return this.buffer=t,void(this.position=0);throw typeof t+" is invalid parameter type for ByteBuffer constructor"}n=t}this.buffer=new Uint8Array(n),this.position=0}size(){return this.buffer.length}reallocate(){const t=new Uint8Array(2*this.buffer.length);t.set(this.buffer),this.buffer=t}shrink(){return this.buffer=this.buffer.subarray(0,this.position),this.buffer}put(t){this.buffer.length<this.position+1&&this.reallocate(),this.buffer[this.position++]=t}get(t){return null==t&&(t=this.position,this.position+=1),this.buffer.length<t+1?0:this.buffer[t]}putShort(t){if(65535<t)throw t+" is over short value";const n=255&t,e=(65280&t)>>8;this.put(n),this.put(e)}getShort(t){if(null==t&&(t=this.position,this.position+=2),this.buffer.length<t+2)return 0;const n=this.buffer[t];let e=(this.buffer[t+1]<<8)+n;return 32768&e&&(e=-(e-1^65535)),e}putInt(t){if(4294967295<t)throw t+" is over integer value";const n=255&t,e=(65280&t)>>8,i=(16711680&t)>>16,s=(4278190080&t)>>24;this.put(n),this.put(e),this.put(i),this.put(s)}getInt(t){if(null==t&&(t=this.position,this.position+=4),this.buffer.length<t+4)return 0;const n=this.buffer[t],e=this.buffer[t+1],i=this.buffer[t+2];return(this.buffer[t+3]<<24)+(i<<16)+(e<<8)+n}readInt(){const t=this.position;return this.position+=4,this.getInt(t)}putString(t){const n=function(t){const n=new Uint8Array(4*t.length);let e=0,i=0;for(;e<t.length;){let s;const r=t.charCodeAt(e++);if(r>=55296&&r<=56319){const n=r,i=t.charCodeAt(e++);if(!(i>=56320&&i<=57343))return null;s=1024*(n-55296)+65536+(i-56320)}else s=r;s<128?n[i++]=s:s<2048?(n[i++]=s>>>6|192,n[i++]=63&s|128):s<65536?(n[i++]=s>>>12|224,n[i++]=s>>6&63|128,n[i++]=63&s|128):s<1<<21&&(n[i++]=s>>>18|240,n[i++]=s>>12&63|128,n[i++]=s>>6&63|128,n[i++]=63&s|128)}return n.subarray(0,i)}(t);for(let t=0;t<n.length;t++)this.put(n[t]);this.put(0)}getString(t){const n=[];let e;for(null==t&&(t=this.position);!(this.buffer.length<t+1)&&(e=this.get(t++),0!==e);)n.push(e);return this.position=t,function(t){let n,e,i,s,r,o,c,h="",u=0;for(;u<t.length;)e=t[u++],e<128?n=e:e>>5==6?(i=t[u++],n=(31&e)<<6|63&i):e>>4==14?(i=t[u++],s=t[u++],n=(15&e)<<12|(63&i)<<6|63&s):(i=t[u++],s=t[u++],r=t[u++],n=(7&e)<<18|(63&i)<<12|(63&s)<<6|63&r),n<65536?h+=String.fromCharCode(n):(n-=65536,o=55296|n>>10,c=56320|1023&n,h+=String.fromCharCode(o,c));return h}(n)}},te=class{dictionary;target_map;pos_buffer;constructor(){this.dictionary=new Yn(10485760),this.target_map={},this.pos_buffer=new Yn(10485760)}buildDictionary(t){const n={};for(let e=0;e<t.length;e++){const i=t[e];if(i.length<4)continue;const s=i[0],r=i[1],o=i[2],c=i[3],h=i.slice(4).join(",");isFinite(r)&&isFinite(o)&&isFinite(c)||console.log(i);n[this.put(r,o,c,s,h)]=s}return this.dictionary.shrink(),this.pos_buffer.shrink(),n}put(t,n,e,i,s){const r=this.dictionary.position,o=this.pos_buffer.position;return this.dictionary.putShort(t),this.dictionary.putShort(n),this.dictionary.putShort(e),this.dictionary.putInt(o),this.pos_buffer.putString(i+","+s),r}addMapping(t,n){let e=this.target_map[t];null==e&&(e=[]),e.push(n),this.target_map[t]=e}targetMapToBuffer(){const t=new Yn,n=Object.keys(this.target_map).length;t.putInt(n);for(const n in this.target_map){const e=this.target_map[n],i=e.length;t.putInt(parseInt(n)),t.putInt(i);for(let n=0;n<e.length;n++)t.putInt(e[n])}return t.shrink()}loadDictionary(t){return this.dictionary=new Yn(t),this}loadPosVector(t){return this.pos_buffer=new Yn(t),this}loadTargetMap(t){const n=new Yn(t);for(n.position=0,this.target_map={},n.readInt();!(n.buffer.length<n.position+1);){const t=n.readInt(),e=n.readInt();for(let i=0;i<e;i++){const e=n.readInt();this.addMapping(t,e)}}return this}getFeatures(t){const n=parseInt(t);if(isNaN(n))return"";const e=this.dictionary.getInt(n+6);return this.pos_buffer.getString(e)}},ne=class{forward_dimension;backward_dimension;buffer;constructor(t,n){this.forward_dimension=t,this.backward_dimension=n,this.buffer=new Int16Array(t*n+2),this.buffer[0]=t,this.buffer[1]=n}put(t,n,e){const i=t*this.backward_dimension+n+2;if(this.buffer.length<i+1)throw"ConnectionCosts buffer overflow";this.buffer[i]=e}get(t,n){const e=t*this.backward_dimension+n+2;if(this.buffer.length<e+1)throw"ConnectionCosts buffer overflow";return this.buffer[e]}loadConnectionCosts(t){this.forward_dimension=t[0],this.backward_dimension=t[1],this.buffer=t}},ee=class{class_id;class_name;is_always_invoke;is_grouping;max_length;constructor(t,n,e,i,s){this.class_id=t,this.class_name=n,this.is_always_invoke=e,this.is_grouping=i,this.max_length=s}},ie=class t{map;lookup_table;constructor(){this.map=[],this.lookup_table={}}init(t){if(null!=t)for(let n=0;n<t.length;n++){const e=t[n];this.map[n]=e,this.lookup_table[e.class_name]=n}}getCharacterClass(t){return this.map[t]}lookup(t){const n=this.lookup_table[t];return n??null}toBuffer(){const t=new Yn;for(let n=0;n<this.map.length;n++){const e=this.map[n];t.put(e.is_always_invoke),t.put(e.is_grouping),t.putInt(e.max_length),t.putString(e.class_name)}return t.shrink(),t.buffer}static load(n){const e=new t,i=[],s=new Yn(n);for(;s.position+1<s.size();){const t=i.length,n=s.get(),e=s.get(),r=s.getInt(),o=s.getString();i.push(new ee(t,o,n,e,r))}return e.init(i),e}},se="DEFAULT",re=class t{character_category_map;compatible_category_map;invoke_definition_map;constructor(){this.character_category_map=new Uint8Array(65536),this.compatible_category_map=new Uint32Array(65536),this.invoke_definition_map=null}initCategoryMappings(t){let n;if(null!=t)for(let e=0;e<t.length;e++){const i=t[e],s=i.end||i.start;for(n=i.start;n<=s;n++){this.character_category_map[n]=this.invoke_definition_map.lookup(i.default);for(let t=0;t<i.compatible.length;t++){let e=this.compatible_category_map[n];const s=i.compatible[t];if(null==s)continue;const r=this.invoke_definition_map.lookup(s);if(null==r)continue;e|=1<<r,this.compatible_category_map[n]=e}}}const e=this.invoke_definition_map.lookup(se);if(null!=e)for(n=0;n<this.character_category_map.length;n++)0===this.character_category_map[n]&&(this.character_category_map[n]=1<<e)}lookupCompatibleCategory(t){const n=[],e=t.charCodeAt(0);let i;if(e<this.compatible_category_map.length&&(i=this.compatible_category_map[e]),null==i||0===i)return n;for(let t=0;t<32;t++)if(i<<31-t>>>31==1){const e=this.invoke_definition_map.getCharacterClass(t);if(null==e)continue;n.push(e)}return n}lookup(t){let n;const e=t.charCodeAt(0);return Tn.isSurrogatePair(t)?n=this.invoke_definition_map.lookup(se):e<this.character_category_map.length&&(n=this.character_category_map[e]),null==n&&(n=this.invoke_definition_map.lookup(se)),this.invoke_definition_map.getCharacterClass(n)}static load(n,e,i){const s=new t;return s.character_category_map=n,s.compatible_category_map=e,s.invoke_definition_map=ie.load(i),s}static parseCharCategory(t,n){const e=n[1],i=parseInt(n[2]),s=parseInt(n[3]),r=parseInt(n[4]);if(!isFinite(i)||0!==i&&1!==i)return console.log("char.def parse error. INVOKE is 0 or 1 in:"+i),null;if(!isFinite(s)||0!==s&&1!==s)return console.log("char.def parse error. GROUP is 0 or 1 in:"+s),null;if(!isFinite(r)||r<0)return console.log("char.def parse error. LENGTH is 1 to n:"+r),null;return new ee(t,e,1===i,1===s,r)}static parseCategoryMapping(t){const n=parseInt(t[1]),e=t[2],i=3<t.length?t.slice(3):[];return(!isFinite(n)||n<0||n>65535)&&console.log("char.def parse error. CODE is invalid:"+n),{start:n,default:e,compatible:i}}static parseRangeCategoryMapping(t){const n=parseInt(t[1]),e=parseInt(t[2]),i=t[3],s=4<t.length?t.slice(4):[];return(!isFinite(n)||n<0||n>65535)&&console.log("char.def parse error. CODE is invalid:"+n),(!isFinite(e)||e<0||e>65535)&&console.log("char.def parse error. CODE is invalid:"+e),{start:n,end:e,default:i,compatible:s}}},oe=class extends te{character_definition;constructor(){super(),this.dictionary=new Yn(10485760),this.target_map={},this.pos_buffer=new Yn(10485760),this.character_definition=null}characterDefinition(t){return this.character_definition=t,this}lookup(t){return this.character_definition?.lookup(t)}lookupCompatibleCategory(t){return this.character_definition?.lookupCompatibleCategory(t)}loadUnknownDictionaries(t,n,e,i,s,r){this.loadDictionary(t),this.loadPosVector(n),this.loadTargetMap(e),this.character_definition=re.load(i,s,r)}},ce=class{trie;token_info_dictionary;connection_costs;unknown_dictionary;constructor(t,n,e,i){var s;this.trie=null!=t?t:(s=0,new Xn(s)).build([{k:"",v:1}]),this.token_info_dictionary=null!=n?n:new te,this.connection_costs=null!=e?e:new ne(0,0),this.unknown_dictionary=null!=i?i:new oe}loadTrie(t,n){return this.trie=function(t,n){let e=Wn(0);return e.loadBaseBuffer(t),e.loadCheckBuffer(n),new Hn(e)}(t,n),this}loadTokenInfoDictionaries(t,n,e){return this.token_info_dictionary.loadDictionary(t),this.token_info_dictionary.loadPosVector(n),this.token_info_dictionary.loadTargetMap(e),this}loadConnectionCosts(t){return this.connection_costs.loadConnectionCosts(t),this}loadUnknownDictionaries(t,n,e,i,s,r){return this.unknown_dictionary.loadUnknownDictionaries(t,n,e,i,s,r),this}};var he=function(t,n,e,i){for(var s,r=arguments.length,o=r<3?n:null===i?i=Object.getOwnPropertyDescriptor(n,e):i,c=t.length-1;c>=0;c--)(s=t[c])&&(o=(r<3?s(o):r>3?s(n,e,o):s(n,e))||o);return r>3&&o&&Object.defineProperty(n,e,o),o};const ue=new class{constructor(t){this.options=t}async build(){const t=await async function(t){const n=new ce;return await Promise.all([async function(){const e=await Promise.all(["base.dat.gz","check.dat.gz"].map((n=>t.loadArrayBuffer(n)))),i=new Int32Array(e[0]),s=new Int32Array(e[1]);n.loadTrie(i,s)}(),async function(){const e=await Promise.all(["tid.dat.gz","tid_pos.dat.gz","tid_map.dat.gz"].map((n=>t.loadArrayBuffer(n)))),i=new Uint8Array(e[0]),s=new Uint8Array(e[1]),r=new Uint8Array(e[2]);n.loadTokenInfoDictionaries(i,s,r)}(),async function(){const e=await t.loadArrayBuffer("cc.dat.gz"),i=new Int16Array(e);n.loadConnectionCosts(i)}(),async function(){const e=await Promise.all(["unk.dat.gz","unk_pos.dat.gz","unk_map.dat.gz","unk_char.dat.gz","unk_compat.dat.gz","unk_invoke.dat.gz"].map((n=>t.loadArrayBuffer(n)))),i=new Uint8Array(e[0]),s=new Uint8Array(e[1]),r=new Uint8Array(e[2]),o=new Uint8Array(e[3]),c=new Uint32Array(e[4]),h=new Uint8Array(e[5]);n.loadUnknownDictionaries(i,s,r,o,c,h)}()]),n}(this.options.loader);return new Fn(t)}}({loader:{async loadArrayBuffer(t){t=t.replace(/\.gz$/,"");const n=await fetch("https://cdn.jsdelivr.net/npm/@aiktb/kuromoji@1.0.2/dict/"+t);if(!n.ok)throw new Error(`Failed to fetch ${t}: ${n.status}`);return n.arrayBuffer()}}}).build();function ae(t){return ue.then((n=>n.tokenize(t)))}function le(t,n,e,i){if(i===n.length)return[];for(let s=e;s<t.length;s++){const e=t[s].reading;if(n.startsWith(e,i)){const r=le(t,n,s+1,i+e.length);if(r)return[s,...r]}}return null}function fe(t,n){if(t.length>0&&Array.isArray(t[0])){const e=t,i=e.map((t=>t.reduce(((t,n)=>t+(n.marked?1:0)),0))),s=Math.max(...i);return e.map(((t,e)=>i[e]===s?fe(t,n):{matched:null}))}const e=t,i=le(e,n,0,0);if(!i)return{matched:null};const s=[];for(const t of i)e[t].marked||(e[t].marked=!0,s.push(t));return{matched:s}}function de(t){return t.some((t=>null!==t.matched&&t.matched.length>0))}function pe(t){if(0===t.length)return null;let n=t[0],e=n.filter((t=>t.marked)).length,i=n.length-e;for(let s=1;s<t.length;s++){const r=t[s],o=r.filter((t=>t.marked)).length,c=r.length-o;(o>e||o===e&&c<i)&&(n=r,e=o,i=c)}return n}function we(t,n){return t.map((t=>t.marked||n?t.surface_form:"記号"!==t.pos?"_".repeat(t.surface_form.length):"")).join("")}let ye=class extends st{constructor(){super(...arguments),this.english="I live in Seattle.",this.skeleton="",this.state="normal",this.question=null,this.answerHiragana=[]}async supplyQuestion(t){this.question=structuredClone(t),this.question.parsed=[],this.english=this.question.english;const n=await ue;this.question.parsed=this.question.japanese.map((t=>n.tokenize(t).filter((t=>" "!==t.surface_form))));const e=pe(this.question.parsed);this.skeleton=we(e,!1),this.state="normal",this.kana.focus(),this._updateDebugFields()}firstUpdated(){this.kana&&(hn(this.kana,{IMEMode:!0}),this.kana.focus())}connectedCallback(){super.connectedCallback(),ue.catch((t=>console.error("tokenizer failed to load",t)))}updated(t){super.updated(t),this.dispatchEvent(new CustomEvent("properties-changed",{detail:[...t.keys()]}))}render(){return J`
      <span id="english" part="english">${this.english}</span><br />
      <span id="skeleton" part="skeleton">${this.renderSkeleton()}</span><br />
      <div class="answer-box">
        <input
          id="kana-input"
          part="kana-input"
          type="text"
          .readOnly=${"completed"===this.state}
          @keydown=${this.handleKeydown}
          @input=${this.handleInput}
          placeholder="答え"
        />
        <button
          class="next-button"
          @click=${this._onNextClick}
          aria-label="Next question"
        >
          Next ➔
        </button>
      </div>
    `}renderSkeleton(){if(!this.question)return J``;const t=pe(this.question.parsed)||[];return J`${t.map((t=>{if("記号"===t.pos&&"completed"!==this.state)return"";if(!t.marked&&"completed"!==this.state)return J`<span class="mask"
          >${"_".repeat(t.surface_form.length)}</span
        >`;const n=Mn(t.reading);return n===t.surface_form?J`${n}`:J`<ruby><rb>${t.surface_form}</rb><rt>${n}</rt></ruby>`}))}`}_onNextClick(){this.dispatchEvent(new CustomEvent("next-question"))}handleInput(t){"error"===this.state&&(this.state="normal")}handleKeydown(t){if(null===this.question)return;if("Enter"!==t.key)return;if("completed"===this.state)return t.preventDefault(),void this._onNextClick();const n=t.target.value,e=this.question.parsed,i=fe(e,function(t="",n={}){const e=Ct(n);if(e.passRomaji)return Zt(t);if(wn(t)||un(t)||zn(t))return Zt(Yt(t.toLowerCase(),e));return Zt(t)}(n));this._updateDebugFields();const s=pe(e);de(i)&&(this.kana.value="");let r=!1;s.every((t=>"記号"===t.pos||t.marked))?(r=!0,this.state="completed"):de(i)?this.state="normal":this.state="error",this.skeleton=we(s,r)}_updateDebugFields(){if(!this.question)return;const t=this.question.parsed;this.answerHiragana=t.map((t=>t.map((t=>Mn(t.reading))).join(" ")))}};ye.styles=((t,...n)=>{const i=1===t.length?t[0]:n.reduce(((n,e,i)=>n+(t=>{if(!0===t._$cssResult$)return t.cssText;if("number"==typeof t)return t;throw Error("Value passed to 'css' function must be a 'css' function result: "+t+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(e)+t[i+1]),t[0]);return new s(i,t,e)})`
    :host {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
      height: 100%;
      min-height: 300px;

      /* allow both light & dark; UA picks based on prefers-color-scheme */
      color-scheme: light dark;

      /* default (light) look */
      border: solid 1px gray;
      padding: 16px;
      max-width: 800px;
      background-color: #fff;
      color: #000;
    }

    :host([state='completed']) span#skeleton {
      color: green;
    }

    :host([state='normal']) input#kana-input {
      border: solid 1px #ccc;
    }

    :host([state='completed']) input#kana-input {
      outline: none;
      box-shadow: 0 0 0 1px green;
    }

    :host([state='error']) input#kana-input {
      animation: shake 0.3s ease-in-out;
      outline: none;
      box-shadow: 0 0 0 1px tomato;
    }

    :host([state='completed']) .next-button {
      display: block; /* show when completed */
    }

    :host([state='completed']) .next-button:hover {
      color: #000;
    }

    .answer-box {
      margin-top: auto;
      position: relative;
      width: 100%;
    }

    .next-button {
      position: absolute;
      top: 50%;
      right: 0.5em;
      transform: translateY(-50%);
      border: none;
      background: none;
      font-size: 1.5em;
      line-height: 1;
      cursor: pointer;
      color: #444;
      display: none; /* hidden by default */
    }

    span#english {
      font-family: 'Noto Sans JP', sans-serif;
      font-size: 30px;
      text-align: center;
      width: 100%;
    }

    span#skeleton {
      font-family: 'Noto Sans JP', sans-serif;
      font-size: 22px;
      text-align: center;
      width: 100%;
    }

    input#kana-input {
      box-sizing: border-box;
      width: 100%;
      padding-left: 2.5em;
      padding-right: 2.5em; /* make room for the arrow */
      border-radius: 8px;

      font-family: 'Noto Sans JP', sans-serif;
      font-size: 22px;
      line-height: 33px;
      text-align: center;
      width: 100%;

      /* light-mode input styling */
      background-color: #fff;
      color: #000;
      border-radius: 8px;
    }

    @media (prefers-color-scheme: dark) {
      :host {
        /* dark-mode host overrides */
        background-color: #121212;
        color: #eee;
        border: solid 1px #444;
      }

      :host([state='completed']) .next-button:hover {
        color: #eee;
      }

      .next-button {
        color: #ccc;
      }

      span#english {
        color: #eee;
      }

      input#kana-input {
        /* dark-mode input overrides */
        background-color: #222;
        color: #eee;
        border: solid 1px #555;
      }

      @keyframes shake {
        0% {
          transform: translateX(0);
        }
        20% {
          transform: translateX(-4px);
        }
        40% {
          transform: translateX(4px);
        }
        60% {
          transform: translateX(-4px);
        }
        80% {
          transform: translateX(4px);
        }
        100% {
          transform: translateX(0);
        }
      }
    }
  `,he([ht({type:String})],ye.prototype,"english",void 0),he([ht({type:String})],ye.prototype,"skeleton",void 0),he([
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */
function(t){return(n,e,i)=>((t,n,e)=>(e.configurable=!0,e.enumerable=!0,e))(0,0,{get(){return(n=>n.renderRoot?.querySelector(t)??null)(this)}})}("#kana-input")],ye.prototype,"kana",void 0),he([ht({type:String,reflect:!0})],ye.prototype,"state",void 0),ye=he([(t=>(n,e)=>{void 0!==e?e.addInitializer((()=>{customElements.define(t,n)})):customElements.define(t,n)})("kana-game")],ye);export{ye as KanaGame,fe as markTokens,ae as tokenize};
